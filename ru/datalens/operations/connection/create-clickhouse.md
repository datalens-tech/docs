---
title: Как создать подключение к {{ CH }}
description: Следуя данной инструкции, вы сможете создать подключение к {{ CH }}.
---

# Создание подключения к {{ CH }}

{% note info %}

Все запросы к данным выполняются с включенным флагом [join_use_nulls]({{ ch.docs }}/operations/settings/settings/#join_use_nulls). Ознакомьтесь с разделом [Особенности работы с подключением к {{ CH }}](#ch-connection-specify), если вы используете представления (VIEW) или подзапросы с секцией JOIN в {{ datalens-short-name }}.

{% endnote %}



Чтобы создать подключение к {{ CH }}:

1. Перейдите на страницу [воркбука](../../workbooks-collections/index.md) или создайте новый.
1. В правом верхнем углу нажмите **Создать** → **Подключение**.
1. Выберите подключение **{{ CH }}**.
1. Укажите параметры подключения для внешней БД {{ CH }}:

   {% include [datalens-db-connection-parameters](../../../_includes/datalens/datalens-db-connection-parameters.md) %}

1. (опционально) Проверьте работоспособность подключения. Для этого нажмите кнопку **Проверить подключение**.
1. Нажмите кнопку **Создать подключение**.
1. Укажите название подключения и нажмите кнопку **Создать**.


## Дополнительные настройки {#clickhouse-additional-settings}

Вы можете указать дополнительные параметры подключения в разделе **Продвинутые настройки подключения**:

* **TLS** — когда опция включена, при взаимодействии с БД используется протокол `HTTPS`, когда выключена — `HTTP`.

* **CA Certificate** — чтобы загрузить сертификат, нажмите кнопку **Прикрепить файл** и укажите файл сертификата. Когда сертификат загружен, поле отображает название файла.

* {% include [datalens-db-connection-export-settings-item](../../../_includes/datalens/operations/datalens-db-connection-export-settings-item.md) %}

* **Readonly** — выберите разрешение для запросов на чтение данных, запись данных и изменение параметров. Значение этой настройки не должно превышать значение соответствующей настройки для пользователя в {{ CH }}:

  * `0` — разрешены все запросы.
  * `1` — разрешены только запросы на чтение данных.
  * `2` — разрешены запросы на чтение данных и изменение настроек.

## Особенности работы с подключением к {{ CH }} {#ch-connection-specify}

Вы можете создавать датасеты поверх представлений (`VIEW`) в {{ CH }}, содержащих секцию `JOIN`. Для этого представление должно быть создано с включенной опцией `join_use_nulls`. Рекомендуется выставлять настройку `join_use_nulls = 1` в секции `SETTINGS`:

```sql
CREATE VIEW ... (
    ...
) AS
    SELECT
        ...
    FROM
        ...
    SETTINGS join_use_nulls = 1
```

Также следует включать эту опцию для подзапросов raw-sql, которые используются как источник данных в датасете.

Чтобы избежать ошибок при работе с представлениями в {{ datalens-short-name }}, содержащими секцию JOIN, создайте заново все представления с настройкой `join_use_nulls = 1`. Пустые ячейки при этом заполнятся значениями `NULL`, а тип соответствующих полей преобразуется в [Nullable]({{ ch.docs }}/sql-reference/data-types/nullable/#data_type-nullable).

{% include [clickhouse-disclaimer](../../../_includes/clickhouse-disclaimer.md) %}

